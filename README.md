# Утилита удаленной перезагрузки ПК (v1.0)

## Назначение
PowerShell-скрипт для безопасной перезагрузки локальных и удаленных компьютеров в корпоративной сети. Обеспечивает проверку доступности целевого ПК, подтверждение действия и мгновенную перезагрузку с возможностью указания причины.

## Основные возможности
- **Интеллектуальная проверка доступности**: Двойной ping-тест перед выполнением
- **Подтверждение действия**: Защита от случайной перезагрузки
- **Мгновенная перезагрузка**: Нулевое время ожидания (/t 0)
- **Указание причины**: Автоматическое добавление комментария администратора
- **Подробная диагностика**: Четкие сообщения об ошибках с возможными причинами
- **Автоповышение прав**: Автоматический перезапуск с правами администратора

## Требования
- **ОС**: Windows 7+ / Windows Server 2008 R2+
- **PowerShell**: Версия 3.0+
- **Права**: Административные права на целевом компьютере
- **Сетевые требования**:
  - Доступ к административным ресурсам (Admin Shares)
  - Открытые порты: 445 (SMB), 135 (RPC)
  - Разрешен ICMP-трафик для проверки доступности

## Инструкция по использованию

### Базовый запуск
```powershell
powershell.exe -ExecutionPolicy Bypass -File "reboot_pc.ps1"
```
(рекомендуется создать ярлык с параметрами: `C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy Bypass -File "\\путь_к_скрипту\reboot_pc.ps1"`)

### Параметры запуска
Скрипт работает в интерактивном режиме и запрашивает:
1. Имя компьютера для перезагрузки
2. Подтверждение действия (Y/N)

## Примеры использования
```powershell
# Перезагрузка локального компьютера
.\reboot_pc.ps1
> Введите имя компьютера: .

# Перезагрузка удаленного компьютера
.\reboot_pc.ps1
> Введите имя компьютера: SRV-AD01

# Массовая перезагрузка через цикл
"WS-001", "WS-002", "SRV-DB01" | ForEach-Object {
    .\reboot_pc.ps1
    > Введите имя компьютера: $_
    > Подтверждение: Y
}
```

## Технические детали

### Метод перезагрузки
- Используется системная утилита `shutdown.exe` с параметрами:
  - `/r` - перезагрузка (вместо выключения)
  - `/m \\computername` - указание целевого компьютера
  - `/t 0` - нулевая задержка перед выполнением
  - `/c "комментарий"` - обязательное указание причины

### Проверки перед выполнением
1. **Права администратора**: Автоматическая проверка и перезапуск
2. **Доступность ПК**: Двойной ping-тест (ICMP)
3. **Подтверждение действия**: Ручное подтверждение оператором

### Обработка ошибок
- **Коды ошибок shutdown.exe** с расшифровкой возможных причин
- **Перехват исключений** с детализацией проблемы
- **Цветовая индикация** статусов (красный/желтый/зеленый)

## Важные примечания
1. **Требования к правам**:
   - Учетная запись должна входить в группу администраторов на целевом ПК
   - Требуется доступ к административным ресурсам (C$, ADMIN$)

2. **Сетевые требования**:
   ```powershell
   # Проверка доступности портов
   Test-NetConnection -ComputerName SRV-AD01 -Port 445
   Test-NetConnection -ComputerName SRV-AD01 -Port 135
   ```

3. **Особенности работы**:
   - Не сохраняет несохраненные данные пользователей
   - Может прерывать текущие сеансы RDP
   - Для критичных серверов рекомендуется предупреждать пользователей

4. **Альтернативные методы**:
   ```powershell
   # Через WinRM (требует предварительной настройки)
   Restart-Computer -ComputerName SRV-AD01 -Force
   ```

## Поддержка
Для отчетов об ошибках или предложений по улучшению обращайтесь к разработчику.  
Copyright © 2025 Кодельник Максим Сергеевич | MIT License  
Версия: 1.0 (2025-08-04)
